<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Custom CMS - Keyword Tool Tutorials</title>
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/marked/marked.min.js"></script>
    <script src="https://unpkg.com/sortablejs@1.15.0/Sortable.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="../index.html" class="text-xl font-bold text-gray-900">
                        üéØ Advanced CMS
                    </a>
                    <span class="ml-2 text-sm text-gray-500">Keyword Tool Tutorials</span>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="../index.html" class="text-gray-700 hover:text-gray-900">‚Üê Back to Site</a>
                    <button id="saveBtn" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-save mr-2"></i>Save All Changes
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            
            <!-- Left Sidebar - Content Management -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-semibold mb-4">üìù Content Management</h2>
                    
                    <!-- Tutorial List -->
                    <div class="mb-6">
                        <h3 class="text-lg font-medium mb-3">Tutorials</h3>
                        <div id="tutorialList" class="space-y-2">
                            <!-- Tutorials will be loaded here -->
                        </div>
                        <button id="addTutorialBtn" class="w-full mt-3 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">
                            <i class="fas fa-plus mr-2"></i>Add New Tutorial
                        </button>
                    </div>

                    <!-- Pages Management -->
                    <div class="mb-6 border-t pt-4">
                        <h3 class="text-lg font-medium mb-3">üìÑ Pages</h3>
                        <div id="pageList" class="space-y-2">
                            <!-- Pages will be loaded here -->
                        </div>
                        <button id="addPageBtn" class="w-full mt-3 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                            <i class="fas fa-file-plus mr-2"></i>Add New Page
                        </button>
                    </div>

                    <!-- Sidebar Management -->
                    <div class="mb-6 border-t pt-4">
                        <h3 class="text-lg font-medium mb-3">üß≠ Sidebar</h3>
                        <div id="sidebarList" class="space-y-2">
                            <!-- Sidebar items will be loaded here -->
                        </div>
                        <button id="addSidebarItemBtn" class="w-full mt-3 bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700">
                            <i class="fas fa-plus mr-2"></i>Add Sidebar Item
                        </button>
                    </div>

                    <!-- Quick Actions -->
                    <div class="border-t pt-4">
                        <h3 class="text-lg font-medium mb-3">‚ö° Quick Actions</h3>
                        <div class="space-y-2">
                            <button id="exportBtn" class="w-full bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700">
                                <i class="fas fa-download mr-2"></i>Export Content
                            </button>
                            <button id="importBtn" class="w-full bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700">
                                <i class="fas fa-upload mr-2"></i>Import Content
                            </button>
                            <button id="previewBtn" class="w-full bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700">
                                <i class="fas fa-eye mr-2"></i>Preview Site
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Area - Editor -->
            <div class="lg:col-span-3">
                <div class="bg-white rounded-lg shadow-md">
                    <!-- Editor Tabs -->
                    <div class="border-b">
                        <nav class="flex space-x-8 px-6">
                            <button class="tab-btn active py-4 px-1 border-b-2 border-blue-500 text-blue-600 font-medium" data-tab="visual-editor">
                                <i class="fas fa-edit mr-2"></i>Visual Editor
                            </button>
                            <button class="tab-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium" data-tab="markdown-editor">
                                <i class="fas fa-code mr-2"></i>Markdown
                            </button>
                            <button class="tab-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium" data-tab="preview">
                                <i class="fas fa-eye mr-2"></i>Preview
                            </button>
                            <button class="tab-btn py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium" data-tab="settings">
                                <i class="fas fa-cog mr-2"></i>Settings
                            </button>
                        </nav>
                    </div>

                    <!-- Visual Editor Tab -->
                    <div id="visual-editor" class="tab-content active p-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Title</label>
                                <input type="text" id="tutorialTitle" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                <textarea id="tutorialDescription" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                                    <select id="tutorialCategory" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="Basics">Basics</option>
                                        <option value="Find Keywords">Find Keywords</option>
                                        <option value="Check Search Volume">Check Search Volume</option>
                                        <option value="Keyword Basket">Keyword Basket</option>
                                        <option value="My Account">My Account</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Difficulty</label>
                                    <select id="tutorialDifficulty" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="Beginner">Beginner</option>
                                        <option value="Intermediate">Intermediate</option>
                                        <option value="Advanced">Advanced</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Content (Visual Editor)</label>
                                <div id="visualEditor" class="border border-gray-300 rounded-md min-h-[400px] p-4 focus-within:ring-2 focus-within:ring-blue-500">
                                    <div id="editableContent" contenteditable="true" class="outline-none min-h-[380px] prose max-w-none">
                                        <h1>Your Tutorial Title</h1>
                                        <p>Start writing your tutorial here. You can use the toolbar above to format your content.</p>
                                        <h2>Section Heading</h2>
                                        <p>Add more content...</p>
                                    </div>
                                </div>
                                
                                <!-- Visual Editor Toolbar -->
                                <div class="mt-2 flex flex-wrap gap-2 p-2 bg-gray-50 rounded-md">
                                    <button class="toolbar-btn" data-command="bold" title="Bold"><i class="fas fa-bold"></i></button>
                                    <button class="toolbar-btn" data-command="italic" title="Italic"><i class="fas fa-italic"></i></button>
                                    <button class="toolbar-btn" data-command="underline" title="Underline"><i class="fas fa-underline"></i></button>
                                    <button class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List"><i class="fas fa-list-ul"></i></button>
                                    <button class="toolbar-btn" data-command="insertOrderedList" title="Numbered List"><i class="fas fa-list-ol"></i></button>
                                    <button class="toolbar-btn" data-command="createLink" title="Insert Link"><i class="fas fa-link"></i></button>
                                    <button class="toolbar-btn" data-command="insertImage" title="Insert Image"><i class="fas fa-image"></i></button>
                                    <button class="toolbar-btn" data-command="formatBlock" data-value="h1" title="Heading 1"><i class="fas fa-heading"></i>1</button>
                                    <button class="toolbar-btn" data-command="formatBlock" data-value="h2" title="Heading 2"><i class="fas fa-heading"></i>2</button>
                                    <button class="toolbar-btn" data-command="formatBlock" data-value="h3" title="Heading 3"><i class="fas fa-heading"></i>3</button>
                                    <button class="toolbar-btn" data-command="formatBlock" data-value="p" title="Paragraph"><i class="fas fa-paragraph"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Markdown Editor Tab -->
                    <div id="markdown-editor" class="tab-content hidden p-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Content (Markdown)</label>
                                <textarea id="tutorialContent" rows="20" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm" placeholder="# Your Tutorial Title

## Introduction

Write your tutorial content here using Markdown...

- Point 1
- Point 2
- Point 3

## Conclusion

End your tutorial here..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Preview Tab -->
                    <div id="preview" class="tab-content hidden p-6">
                        <div class="prose max-w-none">
                            <div id="previewContent" class="bg-gray-50 p-4 rounded-md min-h-[400px]">
                                <p class="text-gray-500 text-center">Preview will appear here...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Tab -->
                    <div id="settings" class="tab-content hidden p-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tutorial Slug</label>
                                <input type="text" id="tutorialSlug" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="keyword-research-basics">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tags (comma separated)</label>
                                <input type="text" id="tutorialTags" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="keyword-research, seo, basics">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Duration</label>
                                <input type="text" id="tutorialDuration" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="10 minutes">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Featured Image URL</label>
                                <input type="url" id="tutorialImage" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://example.com/image.jpg">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Sidebar Link</label>
                                <input type="text" id="tutorialSidebarLink" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="tutorials.html">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Navigation Order</label>
                                <input type="number" id="tutorialOrder" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="1" min="1">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Tutorial Modal -->
    <div id="addTutorialModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
                <div class="px-6 py-4 border-b">
                    <h3 class="text-lg font-medium">Add New Tutorial</h3>
                </div>
                <div class="px-6 py-4">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tutorial Slug</label>
                        <input type="text" id="newTutorialSlug" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="my-new-tutorial">
                    </div>
                </div>
                <div class="px-6 py-4 border-t flex justify-end space-x-3">
                    <button id="cancelAddBtn" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300">Cancel</button>
                    <button id="confirmAddBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Create Tutorial</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Page Modal -->
    <div id="addPageModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
                <div class="px-6 py-4 border-b">
                    <h3 class="text-lg font-medium">Add New Page</h3>
                </div>
                <div class="px-6 py-4">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Page Slug</label>
                        <input type="text" id="newPageSlug" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="about">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Page Title</label>
                        <input type="text" id="newPageTitle" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="About Us">
                    </div>
                </div>
                <div class="px-6 py-4 border-t flex justify-end space-x-3">
                    <button id="cancelAddPageBtn" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300">Cancel</button>
                    <button id="confirmAddPageBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Create Page</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Sidebar Item Modal -->
    <div id="addSidebarItemModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
                <div class="px-6 py-4 border-b">
                    <h3 class="text-lg font-medium">Add Sidebar Item</h3>
                </div>
                <div class="px-6 py-4">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Item Title</label>
                        <input type="text" id="newSidebarTitle" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="New Section">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Link URL</label>
                        <input type="text" id="newSidebarLink" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="new-page.html">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                        <select id="newSidebarCategory" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="BASICS">BASICS</option>
                            <option value="FIND KEYWORDS">FIND KEYWORDS</option>
                            <option value="CHECK SEARCH VOLUME">CHECK SEARCH VOLUME</option>
                            <option value="KEYWORD BASKET">KEYWORD BASKET</option>
                            <option value="MY ACCOUNT">MY ACCOUNT</option>
                        </select>
                    </div>
                </div>
                <div class="px-6 py-4 border-t flex justify-end space-x-3">
                    <button id="cancelAddSidebarBtn" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300">Cancel</button>
                    <button id="confirmAddSidebarBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Add Item</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Advanced Custom CMS JavaScript
        class AdvancedCMS {
            constructor() {
                this.currentTutorial = null;
                this.currentPage = null;
                this.tutorials = this.loadTutorials();
                this.pages = this.loadPages();
                this.sidebar = this.loadSidebar();
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.renderTutorialList();
                this.renderPageList();
                this.renderSidebarList();
                this.setupVisualEditor();
                this.loadSampleTutorial();
            }

            setupEventListeners() {
                // Tab switching
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => this.switchTab(e.target.dataset.tab));
                });

                // Content editing
                document.getElementById('tutorialContent').addEventListener('input', () => this.updatePreview());
                
                // Save button
                document.getElementById('saveBtn').addEventListener('click', () => this.saveAllChanges());
                
                // Add tutorial
                document.getElementById('addTutorialBtn').addEventListener('click', () => this.showAddModal());
                document.getElementById('confirmAddBtn').addEventListener('click', () => this.createTutorial());
                document.getElementById('cancelAddBtn').addEventListener('click', () => this.hideAddModal());
                
                // Add page
                document.getElementById('addPageBtn').addEventListener('click', () => this.showAddPageModal());
                document.getElementById('confirmAddPageBtn').addEventListener('click', () => this.createPage());
                document.getElementById('cancelAddPageBtn').addEventListener('click', () => this.hideAddPageModal());
                
                // Add sidebar item
                document.getElementById('addSidebarItemBtn').addEventListener('click', () => this.showAddSidebarModal());
                document.getElementById('confirmAddSidebarBtn').addEventListener('click', () => this.createSidebarItem());
                document.getElementById('cancelAddSidebarBtn').addEventListener('click', () => this.hideAddSidebarModal());
                
                // Quick actions
                document.getElementById('exportBtn').addEventListener('click', () => this.exportContent());
                document.getElementById('importBtn').addEventListener('click', () => this.importContent());
                document.getElementById('previewBtn').addEventListener('click', () => this.previewSite());
            }

            setupVisualEditor() {
                // Setup toolbar buttons
                document.querySelectorAll('.toolbar-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        const command = btn.dataset.command;
                        const value = btn.dataset.value;
                        
                        if (command === 'createLink') {
                            const url = prompt('Enter URL:');
                            if (url) document.execCommand(command, false, url);
                        } else if (command === 'insertImage') {
                            const url = prompt('Enter image URL:');
                            if (url) document.execCommand(command, false, url);
                        } else if (command === 'formatBlock') {
                            document.execCommand(command, false, value);
                        } else {
                            document.execCommand(command, false, null);
                        }
                        
                        document.getElementById('editableContent').focus();
                    });
                });

                // Sync visual editor with markdown
                document.getElementById('editableContent').addEventListener('input', () => {
                    this.syncVisualToMarkdown();
                });
            }

            syncVisualToMarkdown() {
                const visualContent = document.getElementById('editableContent').innerHTML;
                // Convert HTML to Markdown (simplified)
                let markdown = visualContent
                    .replace(/<h1>/g, '# ')
                    .replace(/<\/h1>/g, '\n\n')
                    .replace(/<h2>/g, '## ')
                    .replace(/<\/h2>/g, '\n\n')
                    .replace(/<h3>/g, '### ')
                    .replace(/<\/h3>/g, '\n\n')
                    .replace(/<p>/g, '')
                    .replace(/<\/p>/g, '\n\n')
                    .replace(/<strong>/g, '**')
                    .replace(/<\/strong>/g, '**')
                    .replace(/<em>/g, '*')
                    .replace(/<\/em>/g, '*')
                    .replace(/<ul>/g, '')
                    .replace(/<\/ul>/g, '\n\n')
                    .replace(/<ol>/g, '')
                    .replace(/<\/ol>/g, '\n\n')
                    .replace(/<li>/g, '- ')
                    .replace(/<\/li>/g, '\n');
                
                document.getElementById('tutorialContent').value = markdown.trim();
            }

            switchTab(tabName) {
                // Hide all tabs
                document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active', 'border-blue-500', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-500');
                });

                // Show selected tab
                document.getElementById(tabName).classList.remove('hidden');
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active', 'border-blue-500', 'text-blue-600');
            }

            loadTutorials() {
                const saved = localStorage.getItem('customCMS_tutorials');
                if (saved) {
                    return JSON.parse(saved);
                }
                return [
                    {
                        slug: 'keyword-research-basics',
                        title: 'Keyword Research Basics',
                        description: 'Learn the fundamentals of keyword research to improve your SEO strategy',
                        category: 'Basics',
                        difficulty: 'Beginner',
                        content: '# Keyword Research Basics\n\nLearn the fundamentals...',
                        tags: ['keyword-research', 'seo', 'basics'],
                        duration: '10 minutes',
                        sidebarLink: 'tutorials.html',
                        order: 1
                    }
                ];
            }

            loadPages() {
                const saved = localStorage.getItem('customCMS_pages');
                if (saved) {
                    return JSON.parse(saved);
                }
                return [
                    {
                        slug: 'about',
                        title: 'About Us',
                        content: '# About Us\n\nLearn about our company...',
                        sidebarLink: 'about.html',
                        order: 1
                    }
                ];
            }

            loadSidebar() {
                const saved = localStorage.getItem('customCMS_sidebar');
                if (saved) {
                    return JSON.parse(saved);
                }
                return [
                    {
                        title: 'Welcome',
                        link: 'index.html',
                        category: 'BASICS',
                        order: 1
                    },
                    {
                        title: 'Tutorials',
                        link: 'tutorials.html',
                        category: 'BASICS',
                        order: 2
                    }
                ];
            }

            renderTutorialList() {
                const list = document.getElementById('tutorialList');
                list.innerHTML = this.tutorials.map(tutorial => `
                    <div class="tutorial-item p-3 border rounded-md cursor-pointer hover:bg-gray-50 ${this.currentTutorial?.slug === tutorial.slug ? 'bg-blue-50 border-blue-200' : ''}" 
                         data-slug="${tutorial.slug}">
                        <h4 class="font-medium text-sm">${tutorial.title}</h4>
                        <p class="text-xs text-gray-500">${tutorial.category} ‚Ä¢ ${tutorial.difficulty}</p>
                    </div>
                `).join('');

                // Add click listeners
                list.querySelectorAll('.tutorial-item').forEach(item => {
                    item.addEventListener('click', () => this.loadTutorial(item.dataset.slug));
                });
            }

            renderPageList() {
                const list = document.getElementById('pageList');
                list.innerHTML = this.pages.map(page => `
                    <div class="page-item p-3 border rounded-md cursor-pointer hover:bg-gray-50" 
                         data-slug="${page.slug}">
                        <h4 class="font-medium text-sm">${page.title}</h4>
                        <p class="text-xs text-gray-500">${page.slug}.html</p>
                    </div>
                `).join('');

                // Add click listeners
                list.querySelectorAll('.page-item').forEach(item => {
                    item.addEventListener('click', () => this.loadPage(item.dataset.slug));
                });
            }

            renderSidebarList() {
                const list = document.getElementById('sidebarList');
                list.innerHTML = this.sidebar.map(item => `
                    <div class="sidebar-item p-3 border rounded-md cursor-pointer hover:bg-gray-50" 
                         data-title="${item.title}">
                        <h4 class="font-medium text-sm">${item.title}</h4>
                        <p class="text-xs text-gray-500">${item.link} ‚Ä¢ ${item.category}</p>
                    </div>
                `).join('');

                // Make sidebar items sortable
                new Sortable(list, {
                    animation: 150,
                    onEnd: () => this.updateSidebarOrder()
                });
            }

            loadTutorial(slug) {
                const tutorial = this.tutorials.find(t => t.slug === slug);
                if (!tutorial) return;

                this.currentTutorial = tutorial;
                this.currentPage = null;
                this.populateForm(tutorial);
                this.renderTutorialList();
                this.renderPageList();
            }

            loadPage(slug) {
                const page = this.pages.find(p => p.slug === slug);
                if (!page) return;

                this.currentPage = page;
                this.currentTutorial = null;
                this.populatePageForm(page);
                this.renderTutorialList();
                this.renderPageList();
            }

            populateForm(tutorial) {
                document.getElementById('tutorialTitle').value = tutorial.title || '';
                document.getElementById('tutorialDescription').value = tutorial.description || '';
                document.getElementById('tutorialCategory').value = tutorial.category || 'Basics';
                document.getElementById('tutorialDifficulty').value = tutorial.difficulty || 'Beginner';
                document.getElementById('tutorialContent').value = tutorial.content || '';
                document.getElementById('tutorialSlug').value = tutorial.slug || '';
                document.getElementById('tutorialTags').value = tutorial.tags?.join(', ') || '';
                document.getElementById('tutorialDuration').value = tutorial.duration || '';
                document.getElementById('tutorialImage').value = tutorial.image || '';
                document.getElementById('tutorialSidebarLink').value = tutorial.sidebarLink || '';
                document.getElementById('tutorialOrder').value = tutorial.order || '';

                // Populate visual editor
                document.getElementById('editableContent').innerHTML = tutorial.content || '<h1>Your Tutorial Title</h1><p>Start writing your tutorial here...</p>';
                
                this.updatePreview();
            }

            populatePageForm(page) {
                document.getElementById('tutorialTitle').value = page.title || '';
                document.getElementById('tutorialDescription').value = '';
                document.getElementById('tutorialCategory').value = 'Basics';
                document.getElementById('tutorialDifficulty').value = 'Beginner';
                document.getElementById('tutorialContent').value = page.content || '';
                document.getElementById('tutorialSlug').value = page.slug || '';
                document.getElementById('tutorialTags').value = '';
                document.getElementById('tutorialDuration').value = '';
                document.getElementById('tutorialImage').value = '';
                document.getElementById('tutorialSidebarLink').value = page.sidebarLink || '';
                document.getElementById('tutorialOrder').value = page.order || '';

                // Populate visual editor
                document.getElementById('editableContent').innerHTML = page.content || '<h1>Your Page Title</h1><p>Start writing your page content here...</p>';
                
                this.updatePreview();
            }

            updatePreview() {
                const content = document.getElementById('tutorialContent').value;
                const preview = document.getElementById('previewContent');
                if (content) {
                    preview.innerHTML = marked.parse(content);
                } else {
                    preview.innerHTML = '<p class="text-gray-500 text-center">Preview will appear here...</p>';
                }
            }

            saveAllChanges() {
                if (this.currentTutorial) {
                    this.saveTutorial();
                } else if (this.currentPage) {
                    this.savePage();
                } else {
                    alert('Please select a tutorial or page to edit first');
                    return;
                }

                // Save all data
                localStorage.setItem('customCMS_tutorials', JSON.stringify(this.tutorials));
                localStorage.setItem('customCMS_pages', JSON.stringify(this.pages));
                localStorage.setItem('customCMS_sidebar', JSON.stringify(this.sidebar));
                
                alert('All changes saved successfully!');
            }

            saveTutorial() {
                if (!this.currentTutorial) return;

                // Update tutorial data
                this.currentTutorial.title = document.getElementById('tutorialTitle').value;
                this.currentTutorial.description = document.getElementById('tutorialDescription').value;
                this.currentTutorial.category = document.getElementById('tutorialCategory').value;
                this.currentTutorial.difficulty = document.getElementById('tutorialDifficulty').value;
                this.currentTutorial.content = document.getElementById('tutorialContent').value;
                this.currentTutorial.slug = document.getElementById('tutorialSlug').value;
                this.currentTutorial.tags = document.getElementById('tutorialTags').value.split(',').map(t => t.trim()).filter(t => t);
                this.currentTutorial.duration = document.getElementById('tutorialDuration').value;
                this.currentTutorial.image = document.getElementById('tutorialImage').value;
                this.currentTutorial.sidebarLink = document.getElementById('tutorialSidebarLink').value;
                this.currentTutorial.order = parseInt(document.getElementById('tutorialOrder').value) || 1;
            }

            savePage() {
                if (!this.currentPage) return;

                // Update page data
                this.currentPage.title = document.getElementById('tutorialTitle').value;
                this.currentPage.content = document.getElementById('tutorialContent').value;
                this.currentPage.slug = document.getElementById('tutorialSlug').value;
                this.currentPage.sidebarLink = document.getElementById('tutorialSidebarLink').value;
                this.currentPage.order = parseInt(document.getElementById('tutorialOrder').value) || 1;
            }

            showAddModal() {
                document.getElementById('addTutorialModal').classList.remove('hidden');
            }

            hideAddModal() {
                document.getElementById('addTutorialModal').classList.add('hidden');
                document.getElementById('newTutorialSlug').value = '';
            }

            showAddPageModal() {
                document.getElementById('addPageModal').classList.remove('hidden');
            }

            hideAddPageModal() {
                document.getElementById('addPageModal').classList.add('hidden');
                document.getElementById('newPageSlug').value = '';
                document.getElementById('newPageTitle').value = '';
            }

            showAddSidebarModal() {
                document.getElementById('addSidebarItemModal').classList.remove('hidden');
            }

            hideAddSidebarModal() {
                document.getElementById('addSidebarItemModal').classList.add('hidden');
                document.getElementById('newSidebarTitle').value = '';
                document.getElementById('newSidebarLink').value = '';
                document.getElementById('newSidebarCategory').value = 'BASICS';
            }

            createTutorial() {
                const slug = document.getElementById('newTutorialSlug').value.trim();
                if (!slug) {
                    alert('Please enter a tutorial slug');
                    return;
                }

                if (this.tutorials.find(t => t.slug === slug)) {
                    alert('A tutorial with this slug already exists');
                    return;
                }

                const newTutorial = {
                    slug,
                    title: 'New Tutorial',
                    description: 'Enter description here',
                    category: 'Basics',
                    difficulty: 'Beginner',
                    content: '# New Tutorial\n\nStart writing your tutorial here...',
                    tags: ['new'],
                    duration: '5 minutes',
                    sidebarLink: `${slug}.html`,
                    order: this.tutorials.length + 1
                };

                this.tutorials.push(newTutorial);
                this.hideAddModal();
                this.renderTutorialList();
                this.loadTutorial(slug);
            }

            createPage() {
                const slug = document.getElementById('newPageSlug').value.trim();
                const title = document.getElementById('newPageTitle').value.trim();
                
                if (!slug || !title) {
                    alert('Please enter both slug and title');
                    return;
                }

                if (this.pages.find(p => p.slug === slug)) {
                    alert('A page with this slug already exists');
                    return;
                }

                const newPage = {
                    slug,
                    title,
                    content: `# ${title}\n\nStart writing your page content here...`,
                    sidebarLink: `${slug}.html`,
                    order: this.pages.length + 1
                };

                this.pages.push(newPage);
                this.hideAddPageModal();
                this.renderPageList();
                this.loadPage(slug);
            }

            createSidebarItem() {
                const title = document.getElementById('newSidebarTitle').value.trim();
                const link = document.getElementById('newSidebarLink').value.trim();
                const category = document.getElementById('newSidebarCategory').value;
                
                if (!title || !link) {
                    alert('Please enter both title and link');
                    return;
                }

                const newItem = {
                    title,
                    link,
                    category,
                    order: this.sidebar.length + 1
                };

                this.sidebar.push(newItem);
                this.hideAddSidebarModal();
                this.renderSidebarList();
            }

            updateSidebarOrder() {
                const items = document.querySelectorAll('.sidebar-item');
                items.forEach((item, index) => {
                    const title = item.dataset.title;
                    const sidebarItem = this.sidebar.find(s => s.title === title);
                    if (sidebarItem) {
                        sidebarItem.order = index + 1;
                    }
                });
            }

            exportContent() {
                const data = {
                    tutorials: this.tutorials,
                    pages: this.pages,
                    sidebar: this.sidebar
                };
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'cms-export.json';
                link.click();
                URL.revokeObjectURL(url);
            }

            importContent() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const imported = JSON.parse(e.target.result);
                            if (imported.tutorials) this.tutorials = imported.tutorials;
                            if (imported.pages) this.pages = imported.pages;
                            if (imported.sidebar) this.sidebar = imported.sidebar;
                            
                            this.renderTutorialList();
                            this.renderPageList();
                            this.renderSidebarList();
                            
                            localStorage.setItem('customCMS_tutorials', JSON.stringify(this.tutorials));
                            localStorage.setItem('customCMS_pages', JSON.stringify(this.pages));
                            localStorage.setItem('customCMS_sidebar', JSON.stringify(this.sidebar));
                            
                            alert('Content imported successfully!');
                        } catch (error) {
                            alert('Error importing content: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            previewSite() {
                window.open('../index.html', '_blank');
            }

            loadSampleTutorial() {
                if (this.tutorials.length > 0) {
                    this.loadTutorial(this.tutorials[0].slug);
                }
            }
        }

        // Initialize CMS when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new AdvancedCMS();
        });
    </script>
</body>
</html>
